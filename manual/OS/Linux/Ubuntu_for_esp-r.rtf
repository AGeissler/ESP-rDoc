{\rtf1\ansi\ansicpg1252\cocoartf1348\cocoasubrtf170
\cocoascreenfonts1{\fonttbl\f0\fswiss\fcharset0 Helvetica;}
{\colortbl;\red255\green255\blue255;}
\paperw11900\paperh16840\margl1440\margr1440\vieww14460\viewh11680\viewkind0
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural

\f0\fs24 \cf0 \
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural\qc

\b \cf0 Installing Ubuntu for use with ESP-r\
24 October 2016\
ESRU, Glasgow, Scotland
\b0 \
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural
\cf0 \
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural

\b \cf0 Introduction
\b0 \
\
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural

\fs20 \cf0 These notes apply to recent Ubuntu versions and other Debian derivatives. There are a number of dependencies needed for ESP-r to be compiled and run so the discussion will include the use of Linux package managers. If you are installing withinin a virtual machine or re-using an existing virtual machine for environments such as VirtualBox or Parallels the look at the last sections of the document.  Scanning this whole document before you begin is a 
\b really good idea
\b0 !\
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural

\fs24 \cf0 \
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural

\b \cf0 Before you start
\b0 \
\
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural

\fs20 \cf0 Have the following information available before you start:\
\
a) the disk space available and RAM  - Linux can take as little as 6GB of disk space and will run with ~1GB of RAM. More memory (e.g. 2 or 3GB) will increase the speed of your assessments and results recovery tasks.  10GB of disk space is ok for general use in a virtual machine or computer with limited disk space.  Complex models can generate results files of 2-5GB so consider the scope of likely work to be carried out.\
\
b) the layout of the disk(s) and partition(s) on the machine - you may be wanting to dual-boot or to use a virtual drive so locate where space is available.  If you are dual booting with Windows install Linux AFTER Windows.\
\
c) the IP address, machine name/domain, router etc.\
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural

\fs24 \cf0 \
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural

\b \cf0 Install sources
\b0 \
\
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural

\fs20 \cf0 Linux distributions are available either as a live CD/DVD with the option to install or as an install direct from CD/DVD.  Live variants will load into memory and after booting offer an 'Install' button.  After clicking on the Install button the process is identical for both. During the install process you will need to confirm your language, location, time and keyboard. ESP-r assumes that real numbers use a decimal point rather than a comma - so look for options to select a US or UK local.\
\
If the machine is to be dual boot and the disk has unpartitioned space then select the option 'largest contiguous free space' in the installer. You also usually options to use the whole disk or to manually edit the partition table. The latter is an option for experts.  Linux installers may offer to resize the current Windows partition to free up space.  Some users might prefer to use something like PartitionMagic on the Windows side first or the free Gpartd Live CD rather than the Linux installer.  \
\
The most simple partitioning scheme involves a "/' partition as well as a Linux swap partition.  Tip: if you have more memory to put in your machine,  do this before the install so that the swap space is appropriate. Some users prefer to have a separate /home partition leaving at least 4GB for the / partition. \
\
With Ubuntu, you will be asked for an initial account/user.  Consider this carefully as there is no 'root' user on a Ubuntu machine. The initial user account is given additional privileges via the 'sudo' command to temporarily acquire the permissions needed for administrative tasks.  Remember the initial account name and password!   You can use the first user as the owner of the simulation software and then create a second account for normal simulation use.  You will be asked the name of the machine.  On a dual-boot PC you will probably use the same name as the other operating system. The name requested is the initial portion of the machine_name.domain internet name.\
\
At the 'ready to install' review the data and take a note of the partitions that are going to be formatted.  If in doubt use the 'back' arrow.  The installer will first format the disk partitions. It will then install the core of the operating system (the number of packages will depend on whether you are using a CD or DVD).\
\
If your computer needs to use a proxy server to reach the internet then set of these details first.  On the first reboot of the machine you may also want to confirm that the proxy is still correctly defined via the system -> preferences menu. If you are given the option to download updates during the initial install this can save time.\
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural

\fs24 \cf0 \
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural

\b \cf0 Software needed to compile and run ESP-r
\b0 \
\
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural

\fs20 \cf0 The base install usually has much of what you need. The installation of new software packages and their dependencies is handled via package managers (command line apt-get) or a graphic package manager such as Synaptic. In the search dialog type in some or all of the package name you are looking for and a list of possible choices will be displayed.  For example, to install the helper tool xfig the syntax would be:\
\

\b   sudo apt-get install xfig\

\b0 \
which will also list and install dependencies needed for the software to run.  The package manager will list current and available packages in various formats.  You can also search for specific packages by name  e.g. ddd (a debugger) and groff (to convert some ESP-r documents into PS files).  In the list below are packages which you will need, they may already be included in your Linux distribution or be listed under a slightly different name.\
\
As the ESP-r community considers the GCC 4.4 compiler as the reference compiler.  You Linux distribution may have newer versions available. It is possible to have multiple compilers as long as you specify which compiler version to use in the Install command line (e.g. --compiler_version -4.4).\
\
Issue sudo apt-get install commands for the following packages:\
build-essential gcc g++ gfortran gdb lib tool libxml2 libxml2-dev libxml2-utils libxslt1-dev libxslt1-dbg\
libx11-6.dbg libx11-dev libgtk2.0-dev libfontconfig1-dbg libcairo2-dbg libpixman-1-0-dbg libxslt1-dbg libgtk2.0-0-dbg\
\
To support viewing of models the following are needed:\
imagemagick xfonts-100dpi\
\
To support access and scripting the following are needed:\
openssh-server ssh csh\
\
For editing text files the following text editors are needed:\
nedit nano\
\
To ensure that fonts are available, log out of your account and log back in.\
\
To find out about the compilers (gcc g++ and gfortran) use commands such as:\

\b   which gcc\
  ls -l /usr/bin/gc*\
  gcc --version\
  which gfortran\
  l s -l /usr/bin/gfor*\
  gfortran --version\
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural

\b0 \cf0 There may be several versions of gcc on your machine.  The gcc --version command tells you the specifics.\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural

\fs24 \cf0 \
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural

\b \cf0 Setting up your account and folders
\b0 \
\
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural

\fs20 \cf0 There are several strategies for setting up user accounts and a location for the ESP-r distribution.  The standard version will often be located in /opt/esru or /usr/esru. If you are developing a custom version it would typically be installed within your own folder structure. To simplify other tasks, create a 'bin' folder within your HOME folder (e.g. /home/fred/bin) and place in it scripts that you use often as well as the 'link_to' script from the source distribution bin folder (see discussion below). You can use the 'link_to' script to point to your preferred version of ESP-r executables.\
\
ESP-r uses a custom Install script. The Install script supports command line directives such as -d /opt/esru  or -d /home/fred/esru_test.  \
\
The following steps will create a standard distribution in the traditional location.  Setup the distribution folder\'85. For example:  \
  
\b sudo mkdir /opt/esru
\b0  \
  
\b sudo chown your_login_name /opt/esru
\b0    \
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural
\cf0 You need to include the directive 
\b --gcc4 
\b0 in the Install script below. And if you want to specify which version of the compiler to use remember to include 
\b --compiler_version -4.4 
\b0 (substitute the specific number to match the name of the executable e.g. gcc-4.8 or gcc-5).\
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural
\cf0 \
Create a folder structure for Source code in your home folder, checkout the current source distribution via the following commands and use the Install script to build the distribution in the folder /usr/esru with the GCC version 4 & 5 compilers:\
\pard\tx560\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural

\b \cf0 \
  cd\
  mkdir Src\
  cd Src\
  mkdir ESPrgit\
  cd ESPrgit\
  git clone --recursive https://github.com/ESP-rCommunity/ESP-rSource.git\
  git clone --recursive https://github.com/ESP-rCommunity/ESP-rDatabases.git\
  git clone --recursive https://github.com/ESP-rCommunity/ESP-rModels.git\
  git clone --recursive https://github.com/ESP-rCommunity/ESP-rDoc.git\
\
\pard\tx560\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural

\b0 \cf0 Then use rsync to get the contents of ESP-rDatabases, ESP-rModels, and ESP-rDoc into a consistent master folder so a full install can be carried out. Here are the steps assuming a folder ESP-rMaster is created:\
\pard\tx560\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural

\b \cf0   mkdir ESP-rMaster\
  rsync -av ESP-rSource/ ESP-rMaster/\
  rsync -av ESP-rDatabases/ ESP-rMaster/data/\
  rsync -av ESP-rDoc/ ESP-rMaster/doc/\
  rsync -av ESP-rModels/ ESP-rMaster/models/\
\
\pard\tx560\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural

\b0 \cf0 In ESP-rMaster will be everything you need to fully build ESP-r. You can remove the hidden .git bookkeepping folders within ESP-rMaster as they are no longer needed. To build ESP-r in this example to /opt/esru give the following commands:\
\pard\tx560\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural

\b \cf0   cd ESP-rMaster\
  ./Install -d /opt/esru --gcc4 --debug\
\pard\tx560\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural

\b0 \cf0 \
(Say yes to XML if you have that library, say yes to databases and yes to example models and say yes to debug.  Go and have a cup of coffee). There are alternatives Install_o1 Install_o2 Install_o3 which impose different compiler options to speed up numerical calculations (1.5-2x at the expense of a longer compile).\
\pard\tx560\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardeftab720
\cf0 You have the option to compile for three different ESP-r interfaces.  The pure-text option is suitable for automated production work as all tasks are carried out via keyboard commands. The X11 interface is the [traditional] interface form.  The GTK interface uses a different graphic library and looks like the Native Windows version of ESP-r. \
\
\pard\tx560\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural
\cf0 Lets say you have your own source code branch.  The process is similar:\
\pard\tx560\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural

\b \cf0 \
  cd\
  mkdir esru_my_branch\
  cd Src\
  svn checkout <location>\
  cd my_branch/\
  ./Install -d /home/my_login_name/esru_my_branch --gcc4 --debug
\b0 \
\
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural
\cf0 Substitute you home folder name and your branch name as required.  Now there are two versions of ESP-r on your machine.  To get the version that you want you will have to manipulate the PATH environment variable to include the folder there the executables are located.  The PATH environment variable is usually defined in the ./profile file in your home folder. You might find a line which includes   
\b PATH="$HOME/bin:$PATH"
\b0 \
\
You could use a text editor to alter this line:  
\b PATH="$HOME/bin:/usr/esru/esp-r/bin:$PATH"
\b0 \
\
You could use a text editor to alter this line:  
\b PATH="$HOME/bin:$HOME/esru_my_branch/esp-r/bin:$PATH"
\b0 \
\
Or, copy the link_to and link_to_bash scripts in the /usr/esru/esp-r/scripts folder into you $HOME/bin folder via the following commands:\
\

\b   cd \
  mkdir bin\
  cp /opt/esru/esp-r/scripts/link_to ~/bin\
  cp /opt/esru/esp-r/scripts/link_to_bash ~/bin\
  cd bin\
  ./link_to /opt/esru/esp-r/bin\
  cd\
  source .profile\
  which prj\

\b0 \
If the 'which prj' commands returns a location the ESP-r executables and libraries are now known.  \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural
\cf0 If you want to be able to use both the X11 and GTK versions of ESP-r you are going to have to use the Install script twice and place the X11 version in one folder structure and the GTK version in another.  Remember to issue a 
\b make clean 
\b0 command in the src folder prior to invoking the installer script the second time.\
\
There are more documents related to managing your source code and working with the subversion source code control environment within the archive folder of the source distribution.  You may also find some useful materials in the folder src/manual/OS.\
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural

\fs24 \cf0 \
\
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural

\b \cf0 The VirtualBox environment
\b0 \
\
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural

\fs20 \cf0 VirtualBox supports a number of combinations of host computer and guest operating system.  This allows you to get Ubuntu running on a variety of computers.  There are other packages from vendors such as VMWare and Parallels for OSX and the procedures will be similar.\
\
Download the installer for VirtualBox (check site via google search).  If this is for a machine used by several people you might choose to do it as Administrator.  \
\
You can either make use of an existing virtual disk (e.g. from another computer) or install the OS from scratch. Using an existing virtual disk tends to require only that you copy the virtual disk file to an appropriate location and then use the disk manager options within the virtual environment to identify the virtual disk file. There will be minimal adjustments once the new virtual computer is up and running,\
\
To install from scratch you must create a virtual disk drive.  With most virtual environments you are given two options - a fixed size or one expands to a maximum size.  The latter is a good choice, it will only be as large as it needs to be. The maximum size cannot be changed so think a bit before you select it. The default size for a new hard disk is 8GB which is sufficient for light use, and if you have space go for 12-20GB.  Keep in mind that you may wish to backup your virtual disk and the size of the virtual disk file limits your options.  You also need to assign memory for the virtual machine.  If you have 2GB of physical memory then allocate 1 GB to the virtual machine.  Additional memory can speed up simulations and reduce the need for disk access during some results recovery tasks. \
\
Check the preferences of the tool to find where the new virtual environment will be storing the files (so you know what to backup). You might want to place it in a less obscure location so it will be easier to backup.  By default VirtualBox will attempt to use what they call host networking and this may require you to log into your computer a second time.\
\
Once you have the details completed you can start up the new virtual computer, it has no operating system so there will be a wizard that will ask some questions.  Place your Ubuntu CD in the drive or identify an iso file to use for the installation.  Go back to the main instructions for the rest of the process.\
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural

\fs24 \cf0 \
\
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural

\b \cf0 Parallels on OSX
\b0 \
\
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural

\fs20 \cf0 An option to VirtualBox is Parallels.  To start from scratch have the Linux CD ready, ask for a new virtual machine and it will identify typical defaults from scanning the CD and create a virtual disk for Ubuntu with minimal interactions. Parallels defaults to a disk image that will grow.  Once the new virtual machine is up and running then follow the standard install process.\
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural

\fs24 \cf0 \
\
\
}